const a7_0x5cf0=['DistributedExecutionApi','apiAxiosInstance','getBranch','post','hash','axiosException','parseCommand','../../../utilities/axios','maxParallel','true','dteStatus','recordMetric','data','map','next','createStartRequest','parallel','value','/nx-cloud/executions/status','NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT','/nx-cloud/executions/start','Completing\x20run\x20group\x20with\x20an\x20error','/nx-cloud/executions/complete-run-group','__esModule','stopAgentsOnFailure','done','throw','runGroup:\x20','RUNNER_FAILURE_PERF_ENTRY','dteStart','defineProperty','stringify','configuration','exit','createMetricRecorder','__awaiter','axiosMultipleTries','error','../../../utilities/environment','status','Workspace\x20is\x20disabled.\x20Cannot\x20perform\x20distributed\x20task\x20executions.','response','target','../../../utilities/nx-imports','note','Starting\x20a\x20distributed\x20execution','VERBOSE_LOGGING','project','createApiAxiosInstance','apply','false','mapRespToPerfEntry','then'];(function(_0x4e7825,_0x5cf027){const _0x5961f6=function(_0x474d0c){while(--_0x474d0c){_0x4e7825['push'](_0x4e7825['shift']());}};_0x5961f6(++_0x5cf027);}(a7_0x5cf0,0x1ad));const a7_0x5961=function(_0x4e7825,_0x5cf027){_0x4e7825=_0x4e7825-0x0;let _0x5961f6=a7_0x5cf0[_0x4e7825];return _0x5961f6;};'use strict';var __awaiter=this&&this[a7_0x5961('0x1e')]||function(_0x23bb14,_0x34cd62,_0x5d727d,_0x5866cc){function _0x39c614(_0x3cda1c){return _0x3cda1c instanceof _0x5d727d?_0x3cda1c:new _0x5d727d(function(_0x100637){_0x100637(_0x3cda1c);});}return new(_0x5d727d||(_0x5d727d=Promise))(function(_0x2fad6c,_0x37a821){function _0xb05b35(_0xa10f2d){try{_0x529549(_0x5866cc[a7_0x5961('0x9')](_0xa10f2d));}catch(_0x565e28){_0x37a821(_0x565e28);}}function _0xbff522(_0x36a784){try{_0x529549(_0x5866cc[a7_0x5961('0x15')](_0x36a784));}catch(_0x51e22a){_0x37a821(_0x51e22a);}}function _0x529549(_0x2736c2){_0x2736c2[a7_0x5961('0x14')]?_0x2fad6c(_0x2736c2[a7_0x5961('0xc')]):_0x39c614(_0x2736c2[a7_0x5961('0xc')])[a7_0x5961('0x2f')](_0xb05b35,_0xbff522);}_0x529549((_0x5866cc=_0x5866cc[a7_0x5961('0x2c')](_0x23bb14,_0x34cd62||[]))[a7_0x5961('0x9')]());});};Object[a7_0x5961('0x19')](exports,a7_0x5961('0x12'),{'value':!![]});exports[a7_0x5961('0xa')]=exports['DistributedExecutionApi']=void 0x0;const axios_1=require(a7_0x5961('0x2'));const environment_1=require(a7_0x5961('0x21'));const metric_logger_1=require('../../../utilities/metric-logger');const serializer_overrides_1=require('../../../utilities/serializer-overrides');const {output}=require(a7_0x5961('0x26'));class DistributedExecutionApi{constructor(_0x2565da){this[a7_0x5961('0x31')]=(0x0,axios_1[a7_0x5961('0x2b')])(_0x2565da);}['start'](_0xccd4c){var _0x3b9dd3;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x19043b=(0x0,metric_logger_1[a7_0x5961('0x1d')])(a7_0x5961('0x18'));let _0x4ae08f;if(environment_1[a7_0x5961('0x29')]){output[a7_0x5961('0x27')]({'title':a7_0x5961('0x28'),'bodyLines':[JSON[a7_0x5961('0x1a')](_0xccd4c,null,0x2)]});}try{_0x4ae08f=yield(0x0,axios_1[a7_0x5961('0x1f')])(()=>this['apiAxiosInstance'][a7_0x5961('0x33')](a7_0x5961('0xf'),_0xccd4c));_0x19043b[a7_0x5961('0x6')]((0x0,metric_logger_1[a7_0x5961('0x2e')])(_0x4ae08f));}catch(_0x358f4e){_0x19043b[a7_0x5961('0x6')](((_0x3b9dd3=_0x358f4e===null||_0x358f4e===void 0x0?void 0x0:_0x358f4e[a7_0x5961('0x0')])===null||_0x3b9dd3===void 0x0?void 0x0:_0x3b9dd3[a7_0x5961('0x24')])?(0x0,metric_logger_1[a7_0x5961('0x2e')])(_0x358f4e['axiosException']['response']):metric_logger_1[a7_0x5961('0x17')]);throw _0x358f4e;}if(!_0x4ae08f[a7_0x5961('0x7')]['enabled']){throw new Error(a7_0x5961('0x23'));}if(_0x4ae08f[a7_0x5961('0x7')][a7_0x5961('0x20')]){throw new Error(_0x4ae08f[a7_0x5961('0x7')]['error']);}return _0x4ae08f[a7_0x5961('0x7')]['id'];});}[a7_0x5961('0x22')](_0x2bdeab){var _0x36564;return __awaiter(this,void 0x0,void 0x0,function*(){const _0xa4c8d8=(0x0,metric_logger_1['createMetricRecorder'])(a7_0x5961('0x5'));try{const _0x308432=yield(0x0,axios_1[a7_0x5961('0x1f')])(()=>this[a7_0x5961('0x31')][a7_0x5961('0x33')](a7_0x5961('0xd'),{'id':_0x2bdeab}));_0xa4c8d8[a7_0x5961('0x6')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0x308432));return _0x308432[a7_0x5961('0x7')];}catch(_0x3fc9ae){_0xa4c8d8[a7_0x5961('0x6')](((_0x36564=_0x3fc9ae===null||_0x3fc9ae===void 0x0?void 0x0:_0x3fc9ae[a7_0x5961('0x0')])===null||_0x36564===void 0x0?void 0x0:_0x36564[a7_0x5961('0x24')])?(0x0,metric_logger_1[a7_0x5961('0x2e')])(_0x3fc9ae[a7_0x5961('0x0')][a7_0x5961('0x24')]):metric_logger_1[a7_0x5961('0x17')]);output['error']({'title':_0x3fc9ae['message']});process[a7_0x5961('0x1c')](0x1);}});}['completeRunGroupWithError'](_0x5970bf,_0x18ce21){var _0x1e6a60;return __awaiter(this,void 0x0,void 0x0,function*(){const _0x1c8420=(0x0,metric_logger_1[a7_0x5961('0x1d')])('completeRunGroup');if(environment_1[a7_0x5961('0x29')]){output[a7_0x5961('0x27')]({'title':a7_0x5961('0x10'),'bodyLines':[a7_0x5961('0x16')+_0x5970bf,'error:\x20'+_0x18ce21]});}try{const _0xdf489a=yield(0x0,axios_1[a7_0x5961('0x1f')])(()=>this[a7_0x5961('0x31')][a7_0x5961('0x33')](a7_0x5961('0x11'),{'runGroup':_0x5970bf,'criticalErrorMessage':_0x18ce21}),0x3);_0x1c8420[a7_0x5961('0x6')]((0x0,metric_logger_1['mapRespToPerfEntry'])(_0xdf489a));}catch(_0x497075){_0x1c8420[a7_0x5961('0x6')](((_0x1e6a60=_0x497075===null||_0x497075===void 0x0?void 0x0:_0x497075[a7_0x5961('0x0')])===null||_0x1e6a60===void 0x0?void 0x0:_0x1e6a60[a7_0x5961('0x24')])?(0x0,metric_logger_1[a7_0x5961('0x2e')])(_0x497075[a7_0x5961('0x0')][a7_0x5961('0x24')]):metric_logger_1[a7_0x5961('0x17')]);}});}}exports[a7_0x5961('0x30')]=DistributedExecutionApi;function createStartRequest(_0x4687c7,_0x396740,_0x20ca7f){const _0x1f61d9=_0x396740['map'](_0x337b57=>{return _0x337b57[a7_0x5961('0x8')](_0x2db256=>{return{'taskId':_0x2db256['id'],'hash':_0x2db256[a7_0x5961('0x34')],'projectName':_0x2db256[a7_0x5961('0x25')][a7_0x5961('0x2a')],'target':_0x2db256[a7_0x5961('0x25')]['target'],'configuration':_0x2db256[a7_0x5961('0x25')][a7_0x5961('0x1b')]||null,'params':(0x0,serializer_overrides_1['serializeOverrides'])(_0x2db256)};});});const _0x302990={'command':(0x0,environment_1[a7_0x5961('0x1')])(),'branch':(0x0,environment_1[a7_0x5961('0x32')])(),'runGroup':_0x4687c7,'tasks':_0x1f61d9,'maxParallel':calculateMaxParallel(_0x20ca7f)};if(environment_1[a7_0x5961('0xe')]){_0x302990['agentCount']=environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_AGENT_COUNT'];}if(!environment_1['NX_CLOUD_DISTRIBUTED_EXECUTION_STOP_AGENTS_ON_FAILURE']){_0x302990[a7_0x5961('0x13')]=![];}return _0x302990;}exports['createStartRequest']=createStartRequest;function calculateMaxParallel(_0x547c99){if(_0x547c99[a7_0x5961('0xb')]===a7_0x5961('0x2d')||_0x547c99['parallel']===![]){return 0x1;}else if(_0x547c99[a7_0x5961('0xb')]===a7_0x5961('0x4')||_0x547c99[a7_0x5961('0xb')]===!![]){return Number(_0x547c99[a7_0x5961('0x3')]||0x3);}else if(_0x547c99[a7_0x5961('0xb')]===undefined){return _0x547c99[a7_0x5961('0x3')]?Number(_0x547c99[a7_0x5961('0x3')]):0x3;}else{return Number(_0x547c99[a7_0x5961('0xb')])||0x3;}}